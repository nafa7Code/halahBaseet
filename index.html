<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ø­Ù„Ù‘Ù‡Ø§ Ø¨Ø³ÙŠØ·</title>
    <style>
      body {
        font-family: "Tahoma", sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f3f4f6;
        color: #333;
      }

      .hero {
        background: linear-gradient(to left, #0077b6, #00b4d8);
        color: white;
        text-align: center;
        padding: 3rem 1rem;
      }

      .hero h2 {
        font-size: 2.5rem;
        margin-bottom: 1rem;
      }

      .hero p {
        font-size: 1.2rem;
      }

      .container {
        max-width: 600px;
        margin: 2rem auto;
        background-color: white;
        padding: 2rem;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }

      label {
        font-weight: bold;
        display: block;
        margin-bottom: 0.5rem;
      }

      textarea,
      select,
      button {
        width: 100%;
        padding: 1rem;
        margin-bottom: 1rem;
        border-radius: 6px;
        border: 1px solid #ccc;
      }

      button {
        background-color: #0077b6;
        color: white;
        font-size: 1rem;
        border: none;
        cursor: pointer;
        transition: 0.3s;
      }

      button:hover {
        background-color: #023e8a;
      }

      #excuseOutput {
        display: none;
        background-color: #e0f7fa;
        padding: 1rem;
        border-radius: 6px;
        margin-top: 1rem;
        border: 1px solid #00acc1;
      }

      #resultMessage {
        font-weight: bold;
        text-align: center;
        margin-top: 1rem;
      }

      #loadingSpinner {
        display: none;
        text-align: center;
        margin-bottom: 1rem;
        color: #0077b6;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
    <div id="header-placeholder"></div>

    <section class="hero">
      <h2>Ù…Ø¹Ù†Ø§ Ø¯Ø§ÙŠÙ… Ø§Ù„Ø­Ù„ Ø¨Ø³ÙŠØ·</h2>
      <p>Ø´Ø§Ø±ÙƒÙ†Ø§ Ù…Ø´ÙƒÙ„ØªÙƒØŒ ÙˆÙ†Ø³Ø§Ø¹Ø¯Ùƒ ØªÙ„Ù‚Ù‰ Ø­Ù„ ÙØ¹Ù‘Ø§Ù„ ÙŠÙ†Ø§Ø³Ø¨Ùƒ ÙˆØ¨Ø·Ø±ÙŠÙ‚ØªÙƒ.</p>
    </section>

    <div class="container">
      <form id="problemForm">
        <label for="problem">ÙˆØ´ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©ØŸ</label>
        <textarea
          id="problem"
          name="problem"
          rows="5"
          placeholder="Ø§ÙƒØªØ¨ Ù…Ø´ÙƒÙ„ØªÙƒ Ù‡Ù†Ø§ Ø¨Ø§Ù„ØªÙØµÙŠÙ„..."
          required
        ></textarea>

        <label for="tone">Ø§Ø®ØªØ± Ù†ØºÙ…Ø© Ø§Ù„Ø±Ø¯:</label>
        <select id="tone" name="tone" required>
          <option value="">Ø§Ø®ØªØ± Ù†ØºÙ…Ø©</option>
          <option value="ÙˆØ§Ù‚Ø¹ÙŠ">ÙˆØ§Ù‚Ø¹ÙŠ</option>
          <option value="Ù…Ø¶Ø­Ùƒ">Ù…Ø¶Ø­Ùƒ</option>
          <option value="Ø³Ø§Ø®Ø±">Ø³Ø§Ø®Ø±</option>
          <option value="ØºØ±ÙŠØ¨">ØºØ±ÙŠØ¨</option>
        </select>

        <button type="submit">Ø£Ø±Ø³Ù„ Ù…Ø´ÙƒÙ„ØªÙƒ</button>
      </form>

      <div id="loadingSpinner">â³ Ø¬Ø§Ø±ÙŠ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¹Ø°Ø±...</div>

      <div id="resultMessage"></div>

      <div id="excuseOutput">
        <strong>ğŸ“£ Ù‡Ø°Ø§ Ù‡Ùˆ Ø¹Ø°Ø±Ùƒ:</strong>
        <p id="excuseText" style="margin-top: 0.5rem"></p>
      </div>
    </div>

    <!-- Ø§Ù„ÙÙˆØªØ± -->
    <div id="footer-placeholder"></div>

    <script>
      // ØªØ­Ù…ÙŠÙ„ Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„ØµÙØ­Ø© (header + footer)
      function loadFragment(selector, file) {
        fetch(file)
          .then((response) => response.text())
          .then((html) => {
            document.querySelector(selector).innerHTML = html;
          });
      }

      loadFragment("#header-placeholder", "header.html");
      loadFragment("#footer-placeholder", "footer.html");

      // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
      document
        .getElementById("problemForm")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          const problem = document.getElementById("problem").value.trim();
          const tone = document.getElementById("tone").value;

          if (!problem || !tone) {
            alert("ÙØ¶Ù„Ø§Ù‹ØŒ Ø£ÙƒÙ…Ù„ ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„");
            return;
          }

          document.getElementById("loadingSpinner").style.display = "block";

          const payload = {
            problem: problem,
            tone: tone,
          };

          fetch("https://n8nreil.nafa7lms.com/webhook/case-recived", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(payload),
          })
            .then((response) => {
              if (!response.ok) throw new Error("ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„");
              return response.json();
            })
            .then((data) => {
              document.getElementById("loadingSpinner").style.display = "none";
              document.getElementById("excuseText").innerText =
                data.output || "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø¯.";
              document.getElementById("excuseOutput").style.display = "block";
              document.getElementById("resultMessage").innerText = "";
              document.getElementById("problemForm").reset();
            })
            .catch((error) => {
              document.getElementById("loadingSpinner").style.display = "none";
              document.getElementById("resultMessage").innerText =
                "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„.";
              document.getElementById("excuseOutput").style.display = "none";
              console.error("Ø®Ø·Ø£:", error);
            });
        });
    </script>
  </body>
</html>
